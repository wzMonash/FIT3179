{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "data": {
    "url": "https://raw.githubusercontent.com/wzMonash/FIT3179/refs/heads/main/A2/combined_data.csv"
  },
  "facet": {"field": "state", "type": "nominal", "title": ""},
  "columns": 2,
  "spec": {
    "transform": [
      {
        "calculate": "datum.type == 'all' ? 'All' : datum.type == 'causing_injury' ? 'Causing Injury' : datum.type == 'murder' ? 'Murder' : datum.type == 'rape' ? 'Rape' : datum.type == 'robbery_gang_armed' ? 'Grouped Armed Robbery' : datum.type == 'robbery_gang_unarmed' ? 'Grouped Unarmed Robbery' : datum.type == 'robbery_solo_armed' ? 'Solo Armed Robbery' : datum.type == 'robbery_solo_unarmed' ? 'Solo Unarmed Robbery' : datum.type == 'break_in' ? 'Break-in' : datum.type == 'theft_other' ? 'Theft (Other)' : datum.type == 'theft_vehicle_lorry' ? 'Theft (Lorry)' : datum.type == 'theft_vehicle_motorcar' ? 'Theft (Motorcar)' : datum.type == 'theft_vehicle_motorcycle' ? 'Theft (Motorcycle)' : datum.type",
        "as": "crime_type_label"
      },
      {"filter": "datum.state != 'Malaysia' && datum.district == 'All' && datum.crime_type_label == 'All'"},
      {
        "aggregate": [{"op": "sum", "field": "crimes", "as": "total_crimes"}],
        "groupby": ["state", "date", "population", "crime_type_label"]
      }
    ],
    "mark": "point",
    "encoding": {
      "x": {
        "field": "population",
        "type": "quantitative",
        "title": "Population"
      },
      "y": {"field": "total_crimes", "type": "quantitative", "title": "Crimes"},
      "tooltip": [
        {"field": "state", "type": "nominal", "title": "State"},
        {
          "field": "total_crimes",
          "type": "quantitative",
          "title": "Number of crimes"
        },
        {"field": "crime_type_label", "type": "nominal", "title": "Crime type"},
        {
          "field": "population",
          "type": "quantitative",
          "title": "Population (thousands)"
        },
        {"field": "date", "type": "quantitative", "title": "Year"}
      ]
    }
  },
  "config": {}
}
